language: java

jdk: oraclejdk8

before_script:
  - if [ "$TRAVIS_BRANCH" == "staging" ]; then export DATABASE_RELEASE_URL="$DATABASE_STAGING_URL"; fi
  - if [ "$TRAVIS_BRANCH" == "master" ];  then export DATABASE_RELEASE_URL="$DATABASE_PRODUCTION_URL"; fi

script:
  - mvn clean install -PdbRecreate

after_success:
  - if [ "$TRAVIS_BRANCH" == "master" ]; then chmod 755 ./update-gh-pages.sh; ./update-gh-pages.sh; fi
after_deploy:
  - chmod 755 ./update-build-number.sh; ./update-build-number.sh
  - if [ "$TRAVIS_BRANCH" == "staging" ]; then chmod 755 ./trigger-rainbow.sh; ./trigger-rainbow.sh; fi

cache:
  directories:
  - $HOME/.m2

# The following global variables are encrypted:
env:
  global:
  # GH_TOKEN
  - secure: AanbVsRGmMQnNolKxIL9p2zHLo59fXcrmRhZG+T1neTBJjlclQSwfwcdNTooNZQaxuJlTaRxWi7J8eTKQnpdjMnun9o1l9K/1NLOxBjlR7/9579p4tV4SLfKcR4OWUDJAs1vv8pXd9CmQpp8ihekXL9yR4Fo8pTbwj6CjnI9J9/5bFrBecU2oxm309qTzGaSofjiO9qEtzNW47ZDtexrpF8DM44rCo05OdysoPav1pVh2s/j9xMXWGKDO8RxkPSTr70rtX7W2OR6JZkz1PaEWrCj1n8SVVoe/Qn946y784BQ7WdlBZDDvwFezqBrLiXhAuuWh0GUI+varRn6MuRbUeujiMhgKkYWPI7GWyPLcgk7xy5hNU3yAy7UTDdnyrXw63l+ClfMuW4TzYU36Mz3DaVVxrNTjX35OBM0j1ZzFTeDJzt3AyfTgicw11IAIi5C/9T1PY4MjShvgC15UDmdZmtHLwJf6Q6OQot4/AcNZffW+/FjDxZ3kap7x1pZe+WhUVvALwEdd5FKLmeql8vydtWeuZKEQromqPR2Y8XcV7fYg4Q+1qwos+pfL9YKDOqamZXu/YIMmiduxFrQMiQhGx2qQFM2AP06QSEc94zhPrEoFoeqetMCSqRm4VEF3R23QGOE2V3H6NZEWgdFRuJduDGNpQvaghxQMYVLIyk1RuI=
  # ACCESS_TOKEN
  - secure: jdRYR3VUlWR8yxC+BQQsrL3E5myGnL4CxTuBEz26taAhcdJGvQoFvutb+LCH0r0WNZ9Ca0DCc32+ocCyTPuArHAanCiNZl8C5MoeC2pMJZbwQeHIAUy+kJJ7TScardKh/FPMRL01O2PxGAh3gm9zCeUglfaQdZfCLU5qDxQxU2iQ49PexWP3sNAUBhN+U+03WWUn4OQorIZQWzGbUv1UYBXguzv6EbXR+iIVZ9Bq6JWo0P0/u+Fp87p4RxhohBrpDEuDhkBb9s77KLO3A7FB/5Cq6du2WlqUSI+ivS9oU9jCqZjZgQPjdQwEP2d+325ESLOMRl6X6lyTeQRZfpkf65m7FEG1g7iIG/v344I01DqF9hgT6hhNSbklS535IITySMeKU/RR6otanSdXWUNK1IowNLkg++gj/8XW3z8JwfTpOqP2WY7CYezomYxLz1C2LkEevH6SMY23vEJRnR3fTmKJWJcujWcq6ZAEO2ja8Lg4VAwKBPijQ3t8QBoywgnmJte9lS5xw881dfkCRuBX8q16dsPBV9I0xyRtREzr0vtTPTPoXJRCaXTRVwaAnpq9L0idNfVpsbitvGmB17NnO0pWzUpuk5jpVMdDGMvXXa+ixbFZr1ivnIq5y0YBaIwKO9jsPAm6aREUpL5ZsOooekTpiXVbs2he18voiqqIAh8=

  # DATABASE_URL
  - secure: bFgK63DoYGifwyv9IK4xAHYx8qkmcvnOU/DpmdhYufH5PB/2Fqpb8xbfb+AFiWGGzqDxC/iLyZg4zdsNlTZtXk7DKcC9PQBAjoJteSDFtco+jrgHt73IJxn8l/LM4MKUYf4AqGIcyVRPTeCeiDtdk+Qp2r2oQ83r+kIpzzboQqMtyfX+5R2NAwsDSDkfNVYqfOBA4vqOvZlblFTJpd8TCwBMKbEWruSxXMCZHXzUGX5zl+EpcU7pQs6+dCUjhO+tTWxv03NlZqDcQN672ZguH2NkbTPhIrZ4l99z4txfjTusIzvOC/bt6iwjgeHqaztQ2uVgnnxMXNFxiVV7/RtRL1f93UOeYy3tHg6mXSx9UHNbBx6evOsiEwtFYhJL+mRU/cvX8k2iNFG6nTGgvdoiVcsVkNvduDqGHK3MG+viaqJ6KD47Y4tYfWq6Yq9TVa0wrvYL6Ey/YVnV6VH7AApnXKhIBeLrhdTIFXTNwM533H8VL+y/wLVhx/Wi4q+VKMXy9AZ2JMvebSoDaUutdanx+qOFYsLOKZMDxWQmKSsAXM4rl0VE1eUd+3FfBMl7UW1zhz+B0yxwOu9Tm5+KQhqwsY8SxjCZNG2SRGF13gYCCRSvBgy0SB1bpBe4FWrb6d3VCSTDpzLZj/P4d2pDR1u31ZjyQ3jPtTrF8fYJqnT3r6E=
  # SPRING_DATASOURCE_URL
  #- secure: E7YilJHFCcHd7JKECUZ7Qfb6m8X8vbFQ1qtSowcGywbXYnJ6RNiW7l1g+aIl/iQWtdoaJSKaj4RSlzTJkvN5zjiHLjO2xJfd8WywMAjgHF/4IbnX5JiOSvxMTuaIYMU52SQSRdQdP0CMzOcnI54guj5q6jJH0XDXb2tCOnhPxm3RuV36LzirRAuMGoBnF/S3OuixKezts3nbHFFvSOV+zK3mLWwRahE11Dbq1h+P/x7nRgb7I1xO1I+bsli95+AvETQGRGCy0UhgQZwjC2iln3sPhwzl+Zw/TYLLSOujqqaF1YgdXKJvyqHjUp6RB6IIclJo9mDaBp7ppdS47OPmh2Uqkeg6O93CM8+jR4rePtChZeHny8mND0ePmnSPWK7+sBS82tbyP6U25beRFViug5Fq/XegBQR0MkF7X9fiJbl5dU4DzA1YdeYaShmGfQkf4VqmyAkmxjFwbCbbzCGHZnc07Qe8rTgZFduCXIoxlkBlKz8Xae+DenwAA2rb3+yt3PK8R6YQVENoNBTtU5V9FcPi/UkxI0CrJQd726TMsFQ2N8WtLZsmRVhsoS0VdQhuXR9icsnPQufwGQcLnekPPOZBg8iRKcrlc5wULgI+glicMgoVervrfgd56SNptSHI2xQIQfgEga3xVKCdY/59Bg7iL3oDOzr4NffMc6xtIpE=
  # SPRING_DATASOURCE_USERNAME
  # SPRING_DATASOURCE_PASSWORD

  # DATABASE_STAGING_URL
  - secure: jJlDryHqJ59L4Na94hBadLfBFGtNOOnq90PmNEZ3HJpiyiJZpg3BkNHzGiIZlyK/QdfnlMka77R8Z3FRd55ZLwXqUCfdyWoBhY5WykwZh9jpoD7fBaVtL8f7p5HmMz654IwjbRudkoroBRsDv4cd1q7pIeCFx7NLwHH7E5xzpc/kgOu2TWjZItJ3i39zLqKkTFtw4owA2BT+aSdmh/dxme8klwrF6y0iieaQ+a6ZqomnlV30JwOIDPcoV17db5XvvStouv7L2D+s6+nDK3NL1zm5f3CbKbMgArv0jRMahnNOyJHbAAYFHL+o5ef8Z+B1Rgtk4XSJYqsiI0EwrfTmCarDLiSFp8OuvipXuwJxra67mkQmWpgLLD39FWAaofkMhY7wuLEfpx7LYY4X0UyGjRwFAj/JL3I4x+3sN9um6S0F/8pvZaHVoiFkiaMf7ZQGGbZNKcVrRX01quDa4YFJEYWJlsWiyUAaJrxmYhKFsFLqtunnhULFQaUf6GCMyxFzqsijy4xFATcXShR/PBTVXjCPkhUNMMqYudvZLCJ7caDkTLoq2Zaq0PuvXlpMtSX5yiwvVtmJdvUe6paIMLXmCmrA9fId0xqRux15rCuvcQjs3HpCS1AdnZn69dWtPIc0h+jQp8Oqy0s9vL8rBoN27QIDa58mlpZ3q9oyIiPPO0Y=
  # DATABASE_PRODUCTION_URL
  - secure: Md5O3nY/Q3KDi1aRy1nEr4P+dMoHzAf1QSBDaVKB/AClVKuMAWK2r6BT+57vTWS7x7bvznT0z+0leYUOkZWQ/MyHymRHplW/qYPB5NpyNc1e4DPYCgHzIbjEn6qpreCiqeDDFu+N3/J+wsXXNf130OLI8EgRfHBTMc2cv/kYbW+4gU/FD3DcyfcmuvxT/WomyA8yCqhCP/YN6B8aWUZXLCbxXb2nGoK3/NiKgzvbct9onOVDNOqEDB1maJHohCBtCqZmNn3dXtlqtmwb5atD9H7O0mf/o4GOKB/zmpF1UYOc3X1gYg5IMx5tq4cv27MObX7EnMQW9BLVESUfVbEicmlHLIOgVXjZxMFKCjRV6P47ewvYrnwwV/qSFmypcQP1DmTK6/f542vcfNanonirIJn+L+5HjT25VymoUNYCgGzWqoBir4Oeo5j5gkoZP9OqFrLAtLuLJL7TqzuGaPLwdOvEYGznh13w60hkh9AgXpGkK1Xf43dEEqzPTL1hXEw6Hrh2e6nFl9czV7EWmrSgDI5rBTCxLrnyuBoCYrtQXMl3g87xZw1+zVw5H6PGfi742T2Y4QzvH6kmEzZmiHK7nLdLmyaYdouOv9XtDgPUdJeA993KY0e9obAjviI45jSNJsN7QUGJJ1uXN448roOS7fzB0nVeZCZCVtK8RZSj/4I=
  # HEROKU_API_TOKEN
  - secure: Xb8yDS6nfC2y5fnHwXZQA62Q0+h2+awWKtBANSDCIWMNz/Al/RGXpY1+KX3WaV4B55HJKC4jRy3FgjV7ydAtaqt5vpzYJJOXsSaxps6P2mlOL3J5+9CcF+nv23Rl7Gsb9MmwT7ddo2uy1Jn2Zms9+TmnLnjUbqYFAv+Igkv95e6DzcqO1ExcSwbxTYorEK7vAu5YKl6dFonpBni0ITGbduNAZMr6pLGcc0yx2EeRzthzlxPD2ml/X3JUcLDzRb4mMONuqR7pKAEKj2pPzWwFSHUQXxOxCuWaPkiM3WOovz26rK+hUe1ltWvf7KX+Ufy5bJfKvLaOt4gaqz/qhvq0rFBZPHGhAc//+Ffm4GFD/r3RGUY1q8fC9vMc6Z7qJS6PP7J/Teurh/pH5goz1PNdck/Sfm8ADvRcLBpZ/FP7mLWzFyGp7Kp+c2LklrVUFjs1uNAbkFtqr9iHcowbpDxcECtzj8OZEt9XADx/v4T/j8Gr+PbWV31+J4d4v89ZrkHalSMIQuBLcU6g9IcQZpUzhpIK1Ziv91H+W79Q5wH1EBQ2Os3Y16mhPBPwp6ZA6fLN9sSCX52ZzPh+pu3yoaw4qwPrRgDvyWR93+wb6rATgUxPuU9MLyR/2biT8ToHojIbMWCgS+zqx0RNGNrUJWAE/ieaye/daMgHdNIhEvvMVaI=

deploy:
  provider: heroku
  api_key:
    secure: f1+vetyOoJyqq4SbN2UFO/DZ9N6srCWYmHX0AC8RgislwefSWzBwKGBLF0ZuYko16eUKbGj2JHh7G91hPnTeVU+bkNPe2EZ4kO2yH5JiLvUVR2XbK6RtN22GHdtSPzKy+YVdMvJ6mG8s4dnTGwl/GYhdTgrZ6bl6kANhT2hZk5n9SvDVJQ+TPotJn8ZyPVnf51//Dhn2acOu6DGV6NuUMQ8pgqlNaQ7UDVc8UzaoxuE6onOQxWrGxksuk/3eWD5vLs+7h+ALGJfPuOSKWoEs41Lw8PtWvsM7vL6ZmXNEXYWbtAjnXBpZWPF5C2F5TE+UJOKPJZID78gaeOkO615KuiC6gLPzLCagiz7h7tcyXqt99YgY84ugH9HqzJUG/3BM88jhCJuqpnp5ykzcWJVCO+0SdCNnZY/OguX2Z6pVDTntq8CIZ5seKGHQT1jHRu19MMCeei8G75mh7Xeq/g4xcGncAsbkMCOtnJ+8VC8uTe7Tvf/Joz+/T7tIaKglBD3P5tZwZX3iF915giN+4JghLcQ6NzrIFL+sbRN76b8XllSaYgK3qSbit7Lh/QjozZBZTjju8gWC2Hn++TDFZwuQPvKRLRAPW0kzdjLhWdDcHomyj4Lb1irQM7jVGMg9C6R/XhAniijWITGzKo4gFC9J5w2zvlNJqyd2HF75ooc/qgM=
  app:
    master: salume-prod
    staging: salume-staging
